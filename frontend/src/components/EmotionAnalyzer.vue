<template>
  <div class="container">
    <h1 class="title">å¿ƒè¿¹æƒ…æ„Ÿåˆ†æ ğŸ’›</h1>
    <textarea v-model="text" placeholder="è¯·è¾“å…¥ä½ çš„å¿ƒæƒ…..." rows="6"></textarea>
    <button @click="analyzeEmotion" :disabled="loading">
      {{ loading ? 'åˆ†æä¸­...' : 'å¼€å§‹åˆ†æ' }}
    </button>

    <div v-if="result" class="result">
      <p><strong>åŸæ–‡ï¼š</strong>{{ result.text }}</p>
      <p><strong>æƒ…ç»ªï¼š</strong>{{ result.mood }}</p>
      <p><strong>åˆ†æ•°ï¼š</strong>{{ result.score }}</p>
      <div class="progress-bar-container">
        <div
            class="progress-bar"
            :style="{ width: (result.score * 100) + '%', backgroundColor: getProgressColor(result.score, result.mood) }"
        >
          {{ Math.round(result.score * 100) }}%
        </div>
      </div>
      <p><strong>å»ºè®®ï¼š</strong>{{ result.advice }}</p>
    </div>
  </div>
</template>

<script setup>
import '../assets/style.css';
import { useEmotion } from '../composables/useEmotion.js';

const { text, result, loading, analyzeEmotion, getProgressColor } = useEmotion();
</script>
